#!/usr/bin/env bash
# Wrapper script that activates venv and runs ansible commands
# Usage: ./wrap-venv <command> [args...]
#
# Examples:
#   ./wrap-venv ansible --version
#   ./wrap-venv ansible all -m ping
#   ./wrap-venv ansible-playbook playbooks/site.yml --check

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_DIR="${SCRIPT_DIR}/.venv"

if [[ ! -f "${VENV_DIR}/bin/activate" ]]; then
    echo "Virtual environment not found. Run ./install-ansible.sh first."
    exit 1
fi

source "${VENV_DIR}/bin/activate"
exec "$@"
